(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30689,        740]
NotebookOptionsPosition[     29527,        699]
NotebookOutlinePosition[     29980,        716]
CellTagsIndexPosition[     29937,        713]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Practical Cryptography #4
Digital Signature Standards\
\>", "Title",
 CellChangeTimes->{{3.4746052435430593`*^9, 3.474605254448821*^9}, {
  3.474605402410968*^9, 3.474605408332881*^9}, {3.6649818396633177`*^9, 
  3.6649818932263813`*^9}, {3.667711936409035*^9, 3.6677119491869135`*^9}, {
  3.667712375155344*^9, 3.6677123912362633`*^9}, {3.668356824961068*^9, 
  3.668356827403208*^9}, {3.6683997844377794`*^9, 3.6683997845577793`*^9}, {
  3.6987724949582615`*^9, 3.6987724949922633`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"98691d81-f7fd-4607-9e9e-e89d204253ec"],

Cell["\<\
\:0411\:0413\:0423, \:041c\:041c\:0424, \:041a\:0430\:0444. \
\:0414\:0423\:0438\:0421\:0410, 
 \:0434\:043e\:0446\:0435\:043d\:0442 \:0427\:0435\:0440\:0433\:0438\:043d\
\:0435\:0446 \:0414.\:041d.\
\>", "SmallText",
 CellChangeTimes->{{3.632746338625765*^9, 3.6327464011153393`*^9}},
 TextAlignment->Right,
 TextJustification->0,ExpressionUUID->"d8bb4bad-0ed0-4b68-a244-8ecca2636dff"],

Cell[CellGroupData[{

Cell["Task 1", "Chapter",
 CellChangeTimes->{{3.6683568929769583`*^9, 3.6683568951430817`*^9}, 
   3.6683569670761967`*^9, {3.7193341484316144`*^9, 
   3.719334149730689*^9}},ExpressionUUID->"6c9cb254-9fe1-4d31-9922-\
f93de3301883"],

Cell["\<\
\:0420\:0435\:0430\:043b\:0438\:0437\:043e\:0432\:0430\:0442\:044c \:043e\
\:0441\:043d\:043e\:0432\:043d\:044b\:0435 \:0430\:043b\:0433\:043e\:0440\
\:0438\:0442\:043c\:044b \:043e\:0434\:043d\:043e\:0433\:043e \:0438\:0437 \
\:0441\:0442\:0430\:043d\:0434\:0430\:0440\:0442\:043e\:0432 \:044d\:043b\
\:0435\:043a\:0442\:0440\:043e\:043d\:043d\:043e\:0439 \:0446\:0438\:0444\
\:0440\:043e\:0432\:043e\:0439 \:043f\:043e\:0434\:043f\:0438\:0441\:0438 \
\:043d\:0430 \:0432\:044b\:0431\:043e\:0440:
- DSA;
- \:0413\:041e\:0421\:0422 \:0420 34.10-94;
- ECDSA;
- \:0413\:041e\:0421\:0422 \:0420 34.10-2012.\
\>", "Text",
 CellChangeTimes->{{3.6683569834411325`*^9, 3.66835698916146*^9}, {
   3.668357319987382*^9, 3.668357378943754*^9}, {3.668357421697199*^9, 
   3.6683574311927423`*^9}, 3.6683574727301183`*^9, {3.668357760557581*^9, 
   3.668357779528666*^9}, {3.668358223256046*^9, 3.6683582287243586`*^9}, {
   3.6683583615289545`*^9, 3.6683583944638386`*^9}, {3.7193341322816906`*^9, 
   3.719334137839009*^9}},
 FontSize->18,ExpressionUUID->"7db62c9f-264a-4924-aca8-0d33adb1f79f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProcedureA", "[", "T_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p", ",", " ", "q", ",", " ", "x", ",", " ", "y", ",", "Y", ",", "t", 
       ",", "c", ",", 
       RowBox[{"s", "=", "0"}], ",", "m", ",", "r", ",", "j", ",", "n", ",", 
       "k", ",", 
       RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
           SuperscriptBox["2", "16"], "-", "1"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["y", "0"], "=", 
       SubscriptBox["x", "0"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
           SuperscriptBox["2", "16"], "-", "1"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "c", "]"}], ",", 
        RowBox[{"c", "=", 
         RowBox[{"c", "-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["t", "i"], "=", "T"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"True", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["t", "i"], "\[GreaterEqual]", "17"}], ",", 
          RowBox[{
           RowBox[{
            SubscriptBox["t", 
             RowBox[{"i", "+", "1"}]], "=", 
            RowBox[{"Floor", "[", 
             FractionBox[
              SubscriptBox["t", "i"], "2"], "]"}]}], ";", 
           RowBox[{"i", "++"}]}], ",", 
          RowBox[{
           RowBox[{"s", "=", "i"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["p", "s"], " ", "=", " ", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                SubscriptBox["t", "s"], "-", "1"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"PrimeQ", "[", 
          SubscriptBox["p", "s"], "]"}]}], ",", 
        RowBox[{
         SubscriptBox["p", "s"], "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"s", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"m", "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "m"], "=", 
          RowBox[{"Ceiling", "[", 
           FractionBox[
            SubscriptBox["t", "m"], "16"], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"While", "[", 
          RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "0"}], ",", 
              RowBox[{"j", "<", 
               SubscriptBox["r", "m"]}], ",", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", 
                 RowBox[{"j", "+", "1"}]], "=", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"19381", 
                    SubscriptBox["y", "j"]}], "+", "c"}], ",", 
                  SuperscriptBox["2", "16"]}], "]"}]}], ";", 
               RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             SubscriptBox["Y", "m"], "=", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "0"}], 
               RowBox[{
                SubscriptBox["r", "m"], "-", "1"}]], 
              RowBox[{
               SubscriptBox["y", "i"], 
               SuperscriptBox["2", "16"]}]}]}], ";", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             SubscriptBox["y", "0"], "=", 
             SubscriptBox["y", 
              SubscriptBox["r", "m"]]}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"n", "=", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               FractionBox[
                SuperscriptBox["2", 
                 RowBox[{
                  SubscriptBox["t", "m"], "-", "1"}]], 
                SubscriptBox["p", 
                 RowBox[{"m", "+", "1"}]]], "]"}], "+", 
              RowBox[{"Floor", "[", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["2", 
                  RowBox[{
                   SubscriptBox["t", "m"], "-", "1"}]], " ", 
                 SubscriptBox["Y", "m"]}], 
                RowBox[{
                 SubscriptBox["p", 
                  RowBox[{"m", "+", "1"}]], " ", 
                 SuperscriptBox["2", 
                  RowBox[{" ", 
                   RowBox[{"16", 
                    SubscriptBox["r", "m"]}]}]]}]], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", "n", "]"}], ",", 
              RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"k", "=", "0"}], ";", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"While", "[", 
             RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{
               RowBox[{
                SubscriptBox["p", "m"], "=", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["p", 
                   RowBox[{"m", "+", "1"}]], 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "k"}], ")"}]}], "+", "1"}]}], ";", 
               "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["p", "m"], ">", 
                  SuperscriptBox["2", 
                   SubscriptBox["t", "m"]]}], ",", 
                 RowBox[{"Break", "[", "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{
                    SubscriptBox["p", 
                    RowBox[{"m", "+", "1"}]], 
                    RowBox[{"(", 
                    RowBox[{"n", "+", "k"}], ")"}]}]], ",", 
                    SubscriptBox["p", "m"]}], "]"}], "\[NotEqual]", "1"}], "||", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"n", "+", "k"}]], ",", 
                    SubscriptBox["p", "m"]}], "]"}], "\[Equal]", "1"}]}], ",", 
                   RowBox[{"k", "=", 
                    RowBox[{"k", "+", "2"}]}], ",", 
                   RowBox[{"Break", "[", "]"}]}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["p", "m"], "\[LessEqual]", 
               SuperscriptBox["2", 
                SubscriptBox["t", "m"]]}], ",", 
              RowBox[{
               RowBox[{"m", "--"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["p", "0"], ",", 
        SubscriptBox["p", "1"]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcedureC", "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "a", ",", 
       RowBox[{"f", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"f", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"p", "-", "2"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"f", "=", " ", 
          RowBox[{"Mod", "[", 
           RowBox[{
            SuperscriptBox["d", 
             FractionBox[
              RowBox[{"p", "-", "1"}], "q"]], ",", "p"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", "f"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.721495300607126*^9, 3.7214953062204475`*^9}, {
   3.721495338940319*^9, 3.7214953696580753`*^9}, {3.7214954515797615`*^9, 
   3.721495462307375*^9}, {3.7214960884391875`*^9, 3.721496162855444*^9}, {
   3.7214963118789673`*^9, 3.721496320894483*^9}, {3.7214964390532417`*^9, 
   3.7214964849808683`*^9}, {3.7214966104760466`*^9, 
   3.7214967291068316`*^9}, {3.721496771371249*^9, 3.7214967780346303`*^9}, {
   3.721496824795305*^9, 3.721496922674903*^9}, {3.7214969973461742`*^9, 
   3.721497188985135*^9}, {3.7214972213689876`*^9, 3.721497249363589*^9}, {
   3.7214978808847094`*^9, 3.7214979834785776`*^9}, {3.7214980198196564`*^9, 
   3.7214980358225718`*^9}, {3.7215020167922697`*^9, 3.721502035102317*^9}, {
   3.721502072766472*^9, 3.7215024019172983`*^9}, {3.7215024365882807`*^9, 
   3.721502605659951*^9}, {3.7215027148681974`*^9, 3.7215027409396887`*^9}, {
   3.721502825499525*^9, 3.7215028647467704`*^9}, {3.7215029383379793`*^9, 
   3.7215030745857725`*^9}, {3.7215031195693455`*^9, 3.721503171913339*^9}, {
   3.721503202313078*^9, 3.7215032822246485`*^9}, {3.721503379792229*^9, 
   3.7215033989993277`*^9}, {3.721503459615795*^9, 3.721503489006476*^9}, {
   3.7215035291587725`*^9, 3.721503652125806*^9}, {3.721503761911085*^9, 
   3.7215037899246874`*^9}, {3.72150392388435*^9, 3.7215040151155677`*^9}, {
   3.721504049635542*^9, 3.721504140825758*^9}, {3.7215044073049994`*^9, 
   3.7215044507594852`*^9}, {3.721504633308926*^9, 3.7215046365711126`*^9}, {
   3.72150481887354*^9, 3.72150482411784*^9}, {3.7215050593602953`*^9, 
   3.721505102837782*^9}, {3.7215052633909645`*^9, 3.721505332979945*^9}, {
   3.7215053935534096`*^9, 3.7215053941294427`*^9}, {3.721505484267598*^9, 
   3.7215056097847776`*^9}, {3.721505654638343*^9, 3.7215056731123996`*^9}, {
   3.7215057482876997`*^9, 3.7215058089261675`*^9}, {3.7215059605398397`*^9, 
   3.7215059829821234`*^9}, {3.7215060854779854`*^9, 3.721506099332778*^9}, {
   3.721506189428931*^9, 3.721506192252093*^9}, {3.721506226140031*^9, 
   3.721506378864766*^9}, {3.721506413090724*^9, 3.7215064692599363`*^9}, {
   3.7215065287233377`*^9, 3.7215065946521087`*^9}, {3.7215066302011423`*^9, 
   3.7215066862843494`*^9}, {3.721506744835699*^9, 3.721506753192177*^9}, {
   3.7215067855920296`*^9, 3.721506820850046*^9}, {3.7215068660446315`*^9, 
   3.7215068666036634`*^9}, {3.7215069099521427`*^9, 3.7215069357216167`*^9}, 
   3.7215069996352725`*^9, {3.7215070495371265`*^9, 3.721507054689421*^9}, {
   3.721507140648338*^9, 3.721507158765374*^9}, {3.7215072619122734`*^9, 
   3.7215072642004046`*^9}, {3.721507388039488*^9, 3.7215074179271975`*^9}, {
   3.7215074505720644`*^9, 3.7215074581204963`*^9}, {3.721507577022297*^9, 
   3.7215075772513103`*^9}, {3.721507635693653*^9, 3.721507640457925*^9}, {
   3.7215076791061363`*^9, 3.7215076868835807`*^9}, {3.7215077300660505`*^9, 
   3.721507786841298*^9}, {3.7215079487115564`*^9, 3.721507957595064*^9}, {
   3.7215080924467773`*^9, 3.7215081545103273`*^9}, 3.721508207830377*^9, {
   3.7215082996826305`*^9, 3.7215083041698875`*^9}, {3.7215102022084494`*^9, 
   3.7215105201596346`*^9}, {3.7215106854240875`*^9, 3.721510694591612*^9}, {
   3.721510752655933*^9, 3.7215107605983872`*^9}, {3.721510879391182*^9, 
   3.721510961853898*^9}, {3.7215111374449415`*^9, 3.721511176036149*^9}, 
   3.7215114071783695`*^9, 3.721511439402212*^9, {3.7215115537537527`*^9, 
   3.7215115564889097`*^9}, {3.721566005690484*^9, 3.7215660389373856`*^9}, {
   3.7215664174550357`*^9, 3.721566420182192*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"p", ",", "q"}], "}"}], "=", 
  RowBox[{"ProcedureA", "[", "18", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrimeQ", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"p", ",", "q"}], "}"}]}], "\[IndentingNewLine]", 
 FractionBox[
  RowBox[{"p", "-", "1"}], "q"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "@", 
    RowBox[{"IntegerDigits", "[", 
     RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"p", ",", "q"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", 
  RowBox[{"ProcedureC", "[", 
   RowBox[{"p", ",", "q"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7215046210882273`*^9, 3.721504628466649*^9}, {
   3.7215053549101996`*^9, 3.721505365165786*^9}, {3.721505460677249*^9, 
   3.721505460797256*^9}, 3.7215054932531123`*^9, {3.7215056220044765`*^9, 
   3.7215056776196575`*^9}, {3.721505829490344*^9, 3.7215059270419235`*^9}, {
   3.721505999394062*^9, 3.721506000954151*^9}, {3.721506092488386*^9, 
   3.7215060931524243`*^9}, {3.7215061656415706`*^9, 3.72150616719966*^9}, {
   3.721506475686304*^9, 3.7215064915332108`*^9}, {3.721506641779804*^9, 
   3.721506642723858*^9}, {3.7215067343570995`*^9, 3.721506735231149*^9}, {
   3.7215068448704205`*^9, 3.721506845773472*^9}, {3.7215069270771227`*^9, 
   3.721506960643042*^9}, {3.7215072424941635`*^9, 3.721507242977191*^9}, {
   3.721507657660909*^9, 3.7215076585339594`*^9}, {3.7215102200964723`*^9, 
   3.72151022092752*^9}, {3.7215109695343375`*^9, 3.7215110567903285`*^9}, {
   3.7215111014068804`*^9, 3.7215111166217504`*^9}, {3.7215114593883553`*^9, 
   3.721511466698774*^9}, {3.7215115783301587`*^9, 3.7215115954261365`*^9}, {
   3.7215116545225167`*^9, 3.7215117055374346`*^9}, {3.7215117659298887`*^9, 
   3.721511768001007*^9}, {3.721511810228422*^9, 3.721511831097616*^9}, {
   3.72151197925609*^9, 3.721511979448101*^9}, {3.721565309819683*^9, 
   3.7215653288027687`*^9}, {3.7215653681120167`*^9, 3.721565386755083*^9}, {
   3.7215656760496297`*^9, 3.7215656763846493`*^9}, {3.7215657426324377`*^9, 
   3.721565745256588*^9}, {3.7215657973925705`*^9, 3.721565806688102*^9}, {
   3.7215664283956614`*^9, 3.721566428587672*^9}, {3.7215665274043245`*^9, 
   3.721566527538332*^9}, {3.7215665826664853`*^9, 3.7215665967542915`*^9}, {
   3.7215666860754004`*^9, 3.72156668834653*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"251347", ",", "257"}], "}"}]], "Output",
 CellChangeTimes->{{3.72156580088477*^9, 3.7215658025538654`*^9}, 
   3.7215658488815155`*^9, 3.721566059899585*^9, 3.7215664814386954`*^9, 
   3.721566553292805*^9, {3.721566590945959*^9, 3.721566597935359*^9}, 
   3.721566688823557*^9, 3.7215708008257504`*^9, 3.72157320462424*^9, 
   3.721573411297061*^9, 3.7215735067115183`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.72156580088477*^9, 3.7215658025538654`*^9}, 
   3.7215658488815155`*^9, 3.721566059899585*^9, 3.7215664814386954`*^9, 
   3.721566553292805*^9, {3.721566590945959*^9, 3.721566597935359*^9}, 
   3.721566688823557*^9, 3.7215708008257504`*^9, 3.72157320462424*^9, 
   3.721573411297061*^9, 3.7215735067145185`*^9}],

Cell[BoxData["978"], "Output",
 CellChangeTimes->{{3.72156580088477*^9, 3.7215658025538654`*^9}, 
   3.7215658488815155`*^9, 3.721566059899585*^9, 3.7215664814386954`*^9, 
   3.721566553292805*^9, {3.721566590945959*^9, 3.721566597935359*^9}, 
   3.721566688823557*^9, 3.7215708008257504`*^9, 3.72157320462424*^9, 
   3.721573411297061*^9, 3.7215735067155185`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18", ",", "9"}], "}"}]], "Output",
 CellChangeTimes->{{3.72156580088477*^9, 3.7215658025538654`*^9}, 
   3.7215658488815155`*^9, 3.721566059899585*^9, 3.7215664814386954`*^9, 
   3.721566553292805*^9, {3.721566590945959*^9, 3.721566597935359*^9}, 
   3.721566688823557*^9, 3.7215708008257504`*^9, 3.72157320462424*^9, 
   3.721573411297061*^9, 3.7215735067175183`*^9}],

Cell[BoxData["160625"], "Output",
 CellChangeTimes->{{3.72156580088477*^9, 3.7215658025538654`*^9}, 
   3.7215658488815155`*^9, 3.721566059899585*^9, 3.7215664814386954`*^9, 
   3.721566553292805*^9, {3.721566590945959*^9, 3.721566597935359*^9}, 
   3.721566688823557*^9, 3.7215708008257504`*^9, 3.72157320462424*^9, 
   3.721573411297061*^9, 3.7215735067195187`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DigitalSignature", "[", 
   RowBox[{"M_", ",", "a_", ",", "p_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "h", ",", "k", ",", "r", ",", "rr", ",", "x", ",", "y", ",", "s", ",", 
      "m", ",", "t1", ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"q", "-", "1"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        SuperscriptBox["a", "x"], ",", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"Hash", "[", 
       RowBox[{"M", ",", "\"\<SHA1\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"h", ",", "q"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"h", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"k", "=", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"q", "-", "1"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"r", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           SuperscriptBox["a", "k"], ",", "p"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"rr", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"r", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rr", "\[Equal]", "0"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"s", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", " ", "rr"}], " ", "+", " ", 
            RowBox[{"k", " ", "h"}]}], ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"s", "\[NotEqual]", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t1", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"rr", ",", "2", ",", "256"}], "]"}]}], ";", " ", 
     RowBox[{"t2", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"s", ",", "2", ",", "256"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"t1", ",", "t2"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m", ",", "y"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.721566709781756*^9, 3.72156679761678*^9}, {
   3.7215668466565847`*^9, 3.721567043231828*^9}, {3.7215670820070457`*^9, 
   3.7215671326719437`*^9}, {3.721567207151204*^9, 3.721567311617179*^9}, {
   3.7215673421349244`*^9, 3.721567469781225*^9}, {3.7215675137737417`*^9, 
   3.7215675205731306`*^9}, {3.7215675862228856`*^9, 3.721567591055162*^9}, {
   3.7215676332875776`*^9, 3.721567636686772*^9}, {3.7215708930240235`*^9, 
   3.7215710280787487`*^9}, {3.7215710656558976`*^9, 
   3.7215711018539677`*^9}, {3.7215712686615086`*^9, 3.721571282644309*^9}, {
   3.7215717056155014`*^9, 3.721571731717994*^9}, 3.7215717789256945`*^9, {
   3.7215720906395235`*^9, 3.721572092839649*^9}, {3.7215723334684124`*^9, 
   3.721572370205514*^9}, {3.721573345636305*^9, 3.7215734345153885`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"m", ",", "y"}], "}"}], "=", 
  RowBox[{"DigitalSignature", "[", 
   RowBox[{"\"\<Hello\>\"", ",", "a", ",", "p", ",", "q"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7215674736784487`*^9, 3.7215674917314806`*^9}, {
   3.7215675649796705`*^9, 3.7215676442352037`*^9}, {3.721571035907196*^9, 
   3.721571055138296*^9}, {3.7215720956758113`*^9, 3.721572097034889*^9}, 
   3.7215723876905136`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "764227788966286889795568501057340191831581898793227722660420054452226655623\
5792", ",", "51655"}], "}"}]], "Output",
 CellChangeTimes->{
  3.721567644594224*^9, 3.721570812488417*^9, {3.721571029400824*^9, 
   3.721571056916398*^9}, {3.721571088847224*^9, 3.7215711028920274`*^9}, 
   3.721571301690398*^9, 3.721571448449792*^9, 3.721571739560443*^9, {
   3.7215719665574265`*^9, 3.7215719761709757`*^9}, {3.721572099404025*^9, 
   3.7215721020431757`*^9}, {3.721572379805063*^9, 3.721572394424899*^9}, {
   3.7215724396304846`*^9, 3.7215724480679674`*^9}, 3.7215732048082504`*^9, {
   3.7215733648234024`*^9, 3.7215734370155315`*^9}, 3.721573506774522*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifySignature", "[", 
   RowBox[{"M_", ",", "m_", ",", "p_", ",", "q_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "h", ",", "v", ",", "z", ",", "u", ",", "t", ",", "rr", ",", "s"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"m", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"512", "-", 
             RowBox[{"Length", "@", "t"}]}]}], "}"}]}], "]"}], ",", "t"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rr", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"t", "\[LeftDoubleBracket]", 
         RowBox[{";;", "256"}], "\[RightDoubleBracket]"}], ",", "2"}], 
       "]"}]}], ";", " ", 
     RowBox[{"s", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"t", "\[LeftDoubleBracket]", 
         RowBox[{"257", ";;"}], "\[RightDoubleBracket]"}], ",", "2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "<", "s", "<", "q"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"0", "<", "rr", "<", "q"}], ")"}]}], ")"}]}], ",", 
       RowBox[{"Return", "[", "\"\<Invalid message\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"Hash", "[", 
       RowBox[{"M", ",", "\"\<SHA1\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"h", ",", "q"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"h", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        SuperscriptBox["h", 
         RowBox[{"q", "-", "2"}]], ",", "q"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["z", "1"], "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"s", " ", "v"}], ",", "q"}], "]"}]}], ";", " ", 
     RowBox[{
      SubscriptBox["z", "2"], "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", "-", "rr"}], ")"}], " ", "v"}], ",", "q"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["a", 
            SubscriptBox["z", "1"]], 
           SuperscriptBox["y", 
            SubscriptBox["z", "2"]]}], ",", "p"}], "]"}], ",", "q"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"rr", ",", "u"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7215675405472727`*^9, 3.7215675628665495`*^9}, {
   3.7215676783061523`*^9, 3.7215677569066477`*^9}, {3.7215678618726516`*^9, 
   3.7215678761144667`*^9}, {3.7215708169806743`*^9, 
   3.7215708532367477`*^9}, {3.7215711159947767`*^9, 3.721571197914462*^9}, {
   3.7215712300853024`*^9, 3.721571247753313*^9}, {3.7215713219615574`*^9, 
   3.72157166451315*^9}, {3.7215717451357613`*^9, 3.721571960087056*^9}, {
   3.7215721108686805`*^9, 3.7215721385192623`*^9}, {3.7215723992761765`*^9, 
   3.7215724314270153`*^9}, {3.7215725730261145`*^9, 3.721572612444369*^9}, 
   3.721572928544449*^9, {3.7215731835090322`*^9, 3.7215731901104097`*^9}, {
   3.7215734770858235`*^9, 3.721573503316324*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VerifySignature", "[", 
  RowBox[{"\"\<Hello\>\"", ",", "m", ",", "p", ",", "q", ",", "y"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7215708395589657`*^9, 3.721570849555537*^9}, {
  3.7215731951646986`*^9, 3.7215731990199194`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"66", ",", "66"}], "}"}]], "Output",
 CellChangeTimes->{
  3.721571814445726*^9, {3.721571950849528*^9, 3.7215719779790792`*^9}, {
   3.721572147538778*^9, 3.72157214949889*^9}, {3.7215724325950823`*^9, 
   3.7215724490850253`*^9}, {3.721572613967456*^9, 3.721572615311533*^9}, 
   3.7215729300935373`*^9, {3.7215731994859457`*^9, 3.721573204874254*^9}, 
   3.7215734116790824`*^9, {3.721573504509392*^9, 3.7215735068595266`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 994},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>1.3 Inherited,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 586, 11, 192, "Title"],
Cell[1169, 35, 396, 8, 57, "SmallText"],
Cell[CellGroupData[{
Cell[1590, 47, 232, 4, 82, "Chapter"],
Cell[1825, 53, 1094, 19, 164, "Text"],
Cell[2922, 74, 12676, 288, 1640, "Input"],
Cell[CellGroupData[{
Cell[15623, 366, 2397, 44, 216, "Input"],
Cell[18023, 412, 414, 7, 39, "Output"],
Cell[18440, 421, 413, 7, 39, "Output"],
Cell[18856, 430, 364, 5, 39, "Output"],
Cell[19223, 437, 408, 7, 39, "Output"],
Cell[19634, 446, 367, 5, 39, "Output"]
}, Open  ]],
Cell[20016, 454, 3763, 92, 763, "Input"],
Cell[CellGroupData[{
Cell[23804, 550, 445, 9, 39, "Input"],
Cell[24252, 561, 701, 12, 39, "Output"]
}, Open  ]],
Cell[24968, 576, 3765, 99, 545, "Input"],
Cell[CellGroupData[{
Cell[28758, 679, 257, 5, 39, "Input"],
Cell[29018, 686, 469, 8, 39, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

